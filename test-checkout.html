<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Checkout</title>
</head>
<body>
    <h1>Checkout Test</h1>
    <button id="updateStock">Update Game Stock</button>
    <button id="testProfile">Test Profile API</button>
    <button id="testOrders">Test Orders API</button>
    <button id="testRentals">Test Rentals API</button>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');
        
        function log(message) {
            console.log(message);
            output.innerHTML += '<p>' + JSON.stringify(message) + '</p>';
        }
        
        document.getElementById('updateStock').addEventListener('click', async () => {
            log('Updating game stock...');
            try {
                const res = await fetch('/api/update-stock', {
                    method: 'POST',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                log('Update Stock Response Status: ' + res.status);
                if (res.ok) {
                    const data = await res.json();
                    log('Stock Update Result: ' + JSON.stringify(data));
                } else {
                    const errorText = await res.text();
                    log('Stock Update Error: ' + errorText);
                }
            } catch (error) {
                log('Stock Update Network Error: ' + error.message);
            }
        });
        
        document.getElementById('testProfile').addEventListener('click', async () => {
            log('Testing Profile API...');
            try {
                const res = await fetch('/api/profile', {
                    method: 'GET',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                log('Profile Response Status: ' + res.status);
                if (res.ok) {
                    const data = await res.json();
                    log('Profile Data: ' + JSON.stringify(data));
                } else {
                    const errorText = await res.text();
                    log('Profile Error: ' + errorText);
                }
            } catch (error) {
                log('Profile Network Error: ' + error.message);
            }
        });
        
        document.getElementById('testOrders').addEventListener('click', async () => {
            log('Testing Orders API...');
            try {
                const orderData = {
                    email: 'test@test.com',
                    total: 59.99,
                    status: 'Pending',
                    games: [
                        {
                            gameId: '1',
                            title: 'Test Game',
                            quantity: 1,
                            price: 59.99
                        }
                    ]
                };
                
                const res = await fetch('/api/orders', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(orderData)
                });
                log('Orders Response Status: ' + res.status);
                if (res.ok) {
                    const data = await res.json();
                    log('Order Data: ' + JSON.stringify(data));
                } else {
                    const errorText = await res.text();
                    log('Order Error: ' + errorText);
                }
            } catch (error) {
                log('Order Network Error: ' + error.message);
            }
        });
        
        document.getElementById('testRentals').addEventListener('click', async () => {
            log('Testing Rentals API...');
            try {
                const rentalData = {
                    gameId: '1',
                    days: 3
                };
                
                const res = await fetch('/api/rentals/user', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(rentalData)
                });
                log('Rentals Response Status: ' + res.status);
                if (res.ok) {
                    const data = await res.json();
                    log('Rental Data: ' + JSON.stringify(data));
                } else {
                    const errorText = await res.text();
                    log('Rental Error: ' + errorText);
                }
            } catch (error) {
                log('Rental Network Error: ' + error.message);
            }
        });
    </script>
</body>
</html>
